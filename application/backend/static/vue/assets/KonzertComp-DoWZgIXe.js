import{r as o,am as Rr,an as Nn,ao as Tr,a7 as q,j as r,F as H,f as ae,N as Mr,m as de,ap as pt,aq as Ar,c as W,ab as In,e as D,U as ot,ar as ie,as as ee,i as E,C as m,at as zr,au as Le,S as ye,av as P,aw as Fn,ax as lt,ay as J,D as Or,az as Un,a5 as Kn,ag as Pr,aA as mt,aB as Nr,aC as Ir,aD as qe,aE as Fr,aF as xn,g as Lt,aG as Ur,n as z,aH as Be,aI as Kr,a1 as ze,aJ as Br,aK as It,aL as Lr,ah as Hr,L as He,Z as $r,V as Gr,aM as Vr,aN as Bn,a2 as We,aj as Ht,I as $t,aO as Wr,J as Yr,aP as Ln,aQ as Xr,aR as je,aS as Jr,M as vn,aT as qr,aU as _r,X as Zr,d as Hn,aV as Qr,aW as es,aX as ts,aY as ns,aZ as rs,H as ss,a4 as as,a_ as is,a$ as os,b0 as ls,b1 as cs,b2 as us,u as ds,ac as Dt,b3 as hs,b4 as fs,b5 as gs,ad as ps,b6 as ms,b7 as bs}from"./main-zpu8IzFY.js";import{u as xs,S as vs,K as Ft,U as ys,a as js,M as ks,T as ws,L as re,b as Rt,A as Es,P as Cs,d as Ss,c as Ds}from"./dynamicHeaderTags-BAXiDkFX.js";var Rs=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]]);return n};const{TimePicker:Ts,RangePicker:Ms}=Nn,As=o.forwardRef((e,t)=>o.createElement(Ms,Object.assign({},e,{picker:"time",mode:void 0,ref:t}))),_e=o.forwardRef((e,t)=>{var{addon:n,renderExtraFooter:s,variant:a,bordered:i}=e,l=Rs(e,["addon","renderExtraFooter","variant","bordered"]);const[c]=Rr("timePicker",a,i),u=o.useMemo(()=>{if(s)return s;if(n)return n},[n,s]);return o.createElement(Ts,Object.assign({},l,{mode:void 0,ref:t,renderExtraFooter:u,variant:c}))}),$n=Tr(_e,"popupAlign",void 0,"picker");_e._InternalPanelDoNotUseOrYouWillBeFired=$n;_e.RangePicker=As;_e._InternalPanelDoNotUseOrYouWillBeFired=$n;function Gn({optionen:e,onChange:t}){const n=q();return r.jsx(H.Item,{label:r.jsx("b",{style:{whiteSpace:"nowrap"},children:"Preisprofil:"}),name:["eintrittspreise","preisprofil"],trigger:"onValueAsObject",valuePropName:"valueAsObject",children:r.jsx(zs,{disabled:n.getFieldValue(["kasse","kassenfreigabe"]),onChange:t,optionen:e})})}function zs({id:e,onValueAsObject:t,optionen:n,valueAsObject:s,onChange:a,disabled:i}){function l(g){return{label:r.jsxs("span",{children:[g.name," ",g.veraltet?"(Nicht aktuell)":"",r.jsxs("small",{children:[" ",`(${g.regulaer},00, ${g.regulaer-g.rabattErmaessigt},00, ${g.regulaer-g.rabattMitglied},00)`]})]}),value:g.name}}const c=o.useMemo(()=>{const g=[...n.preisprofile];return s&&!ae(n.preisprofile,{name:s.name})&&g.push({...s,veraltet:!0}),Mr(g,"regulaer")},[n,s]),u=o.useMemo(()=>de(c,l),[c]),[d,h]=o.useState();o.useEffect(()=>{h(s==null?void 0:s.name)},[s]);const f=o.useCallback(g=>{const p=ae(c,{name:g});t==null||t(p),a==null||a(p)},[c,t,a]);return r.jsx(pt,{disabled:i,id:e,onSelect:f,options:u,value:d})}function Os(e){const t=Ar();return r.jsx(H.Item,{label:r.jsx("b",{children:"Typ:"}),name:["kopf","eventTyp"],required:!0,rules:[{required:!0}],children:r.jsx(pt,{options:t,...e,showSearch:!0})})}function se({name:e,label:t,disabled:n,onChange:s}){return r.jsx(m,{span:6,children:r.jsx(lt,{disabled:n,label:t,name:e,onChange:s})})}function Ps(){const e=q(),{currentUser:t,optionen:n,orte:s,allUsers:a}=W(),{presseChecked:i}=xs(!1),{url:l}=In(),c=D("id",{preserve:!0});o.useEffect(()=>{(l!=null&&l.endsWith("new")||l!=null&&l.includes("copy-of"))&&t&&e.setFieldValue("booker",[t.id])},[t,e,c,l]);const u=o.useMemo(()=>ot(a,"accessrights.isBookingTeam"),[a]),d=o.useMemo(()=>de(u,"asUserAsOption"),[u]),h=o.useMemo(()=>t.accessrights.isBookingTeam,[t.accessrights.isBookingTeam]),f=o.useCallback(()=>{const g=new ie(e.getFieldsValue(!0)),p=ae(s.orte,["name",g.kopf.ort]);p&&e.setFieldsValue({kopf:{pressename:p.pressename||g.kopf.ort,presseIn:p.presseIn||p.pressename,flaeche:p.flaeche}}),e.validateFields()},[e,s.orte]);return o.useEffect(f,[f]),r.jsxs(ee,{label:"Event",noTopBorder:!0,suffix:"allgemeines",children:[r.jsxs(E,{children:[r.jsx(se,{disabled:!h,label:"Ist bestätigt",name:["kopf","confirmed"]}),r.jsx(se,{label:"Technik ist geklärt",name:["technik","checked"]}),r.jsx(se,{label:"Braucht Presse",name:"brauchtPresse"}),r.jsx(se,{label:"Presse OK",name:["presse","checked"],onChange:i}),r.jsx(se,{label:"Ist abgesagt",name:["kopf","abgesagt"]}),r.jsx(se,{label:"Braucht Hotel",name:["artist","brauchtHotel"]}),r.jsx(se,{label:"Flügel stimmen",name:["technik","fluegel"]}),r.jsx(se,{label:"Fotograf einladen",name:["kopf","fotografBestellen"]}),r.jsx(se,{label:"Ist auf Homepage",name:["kopf","kannAufHomePage"]}),r.jsx(se,{label:"Kann Social Media",name:["kopf","kannInSocialMedia"]}),r.jsx(m,{span:12,children:r.jsx(zr,{label:"Booker",name:"booker",usersAsOptions:d})})]}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Le,{label:"Titel",name:["kopf","titel"],required:!0})}),r.jsx(m,{span:12,children:r.jsx(Os,{})})]}),r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(vs,{})})}),r.jsxs(E,{children:[r.jsx(m,{span:8,children:r.jsx(ye,{label:"Ort",name:["kopf","ort"],onChange:f,options:s.alleNamen()})}),r.jsx(m,{span:8,children:r.jsx(P,{decimals:0,label:"Fläche",name:["kopf","flaeche"]})}),r.jsx(m,{span:8,children:r.jsx(P,{decimals:2,disabled:!0,label:"Saalmiete (alt)",name:["kosten","saalmiete"],suffix:"€"})})]}),r.jsxs(E,{children:[r.jsx(m,{span:7,children:r.jsx(ye,{label:"Koop (Rechnung)",name:["kopf","kooperation"],options:n.kooperationen})}),r.jsx(m,{span:1,children:r.jsx(H.Item,{label:" ",name:["kopf","rechnungAnKooperation"],valuePropName:"checked",children:r.jsx(Fn,{})})}),r.jsx(m,{span:8,children:r.jsx(Gn,{optionen:n})}),r.jsx(m,{span:8,children:r.jsx(ye,{label:"Genre",name:["kopf","genre"],options:n.genres})})]})]})}function Ns({name:e,label:t,required:n,initialValue:s,baseValue:a}){const[i,l]=o.useState(void 0);return o.useEffect(()=>{const c=[];n&&c.push({required:!0}),l(c)},[n]),r.jsx(H.Item,{initialValue:s,label:t?r.jsx("b",{style:{whiteSpace:"nowrap"},children:t+":"}):"",name:e,rules:i,style:t?{}:{marginBottom:0},children:r.jsx(Is,{baseValue:a})})}function Is({baseValue:e,value:t,onChange:n}){const s=o.useMemo(()=>{if(t)return J(t)},[t]),a=o.useCallback(i=>n(i?Or.forJSDate(e).setUhrzeit(i.hour(),i.minute()).toJSDate:void 0),[n,e]);return o.useEffect(()=>{a(s)},[e]),r.jsx(_e,{format:"HH:mm",minuteStep:15,onChange:a,value:s})}function Fs(){const{optionen:e}=W(),t=D("startDate",{preserve:!0});return r.jsxs(ee,{label:"Künstler",suffix:"allgemeines",children:[r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Le,{label:"Bandname",name:["artist","bandname"]})}),r.jsx(m,{span:6,children:r.jsx(P,{decimals:0,label:"Musiker",min:0,name:["artist","numMusiker"]})}),r.jsx(m,{span:6,children:r.jsx(P,{decimals:0,label:"Crew",min:0,name:["artist","numCrew"]})})]}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Un,{label:"Namen",name:["artist","name"],options:e.artists})}),r.jsx(m,{span:6,children:r.jsx(P,{decimals:2,label:"Gage (Netto)",name:["kosten","gagenEUR"],suffix:"€"})}),r.jsx(m,{span:6,children:r.jsx(ye,{label:"Deal",name:["kosten","deal"],options:Ft.deals})})]}),r.jsxs(E,{children:[r.jsxs(m,{span:12,children:[r.jsx(Ns,{baseValue:t,label:"Band Get-In (informativ)",name:["artist","getInForMasterDate"]}),";"]}),r.jsx(m,{span:12,children:r.jsx(ye,{label:"Transport",name:["artist","bandTransport"],options:["Band kommt selbst","Band abholen (Auto)","Band abholen (Transporter)"]})})]})]})}class Us{constructor(t){this.adresse="",this.ansprechpartner="",this.email="",this.name="",this.telefon="",t&&Kn(t).length&&Object.assign(this,t)}line(t,n="-"){return this.addressLines[t]||n}get strasse(){return this.line(0)}get ort(){return this.line(1)}get addressLines(){return this.adresse?this.adresse.match(/[^\r\n]+/g)??[]:[]}get einzeiligeAdresse(){if(this.adresse){const t=this.adresse.match(/[^\r\n]+/g);return(t==null?void 0:t.join(", "))||""}return"-"}}function Vn({kontakte:e,selector:t,noTopBorder:n,children:s}){const a=q(),i=o.useContext(Pr),{agenturauswahl:l,setAgenturauswahl:c,hotelauswahl:u,setHotelauswahl:d}=o.useContext(mt),[h,f]=o.useState([]);o.useEffect(()=>{const x=Nr(Ir(de(e,"name")));f(["[temporär]","[neu]"].concat(x))},[e]);const g=o.useMemo(()=>de(h,x=>({label:x,value:x})),[h]),p=o.useCallback(x=>{if(x==="[temporär]")return;const b=new Us(ae(e,{name:x})),y={};y[t]={adresse:b.adresse,ansprechpartner:b.ansprechpartner,email:b.email,name:b.name,telefon:b.telefon},a.setFieldsValue(y),t==="agentur"?c(x):t==="hotel"&&d(x),i.checkDirty()},[e,t,a,c,d,i]);return r.jsxs(ee,{label:t==="agentur"?"Agentur":"Hotel",noTopBorder:n,suffix:t==="agentur"?"allgemeines":"hotel",children:[r.jsxs(E,{children:[r.jsxs(m,{span:12,children:[r.jsx(H.Item,{label:r.jsx("b",{children:"Auswahl:"}),children:r.jsx(pt,{onChange:p,options:g,showSearch:!0,value:t==="agentur"?l:u})}),r.jsx(Le,{label:"Name",name:[t,"name"]})]}),r.jsx(m,{span:12,children:r.jsx(H.Item,{label:r.jsx("b",{children:"Adresse:"}),name:[t,"adresse"],children:r.jsx(qe,{rows:7})})})]}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Le,{label:"Telefon",name:[t,"telefon"]})}),r.jsx(m,{span:12,children:r.jsx(Le,{isEmail:!0,label:"E-Mail",name:[t,"email"]})})]}),s]})}function Ks(){const e=q(),{currentUser:t,isDirty:n}=W(),s=o.useMemo(()=>t.accessrights.isBookingTeam,[t.accessrights.isBookingTeam]),a=D("id",{preserve:!0}),i=o.useCallback(()=>Fr(new ie(e.getFieldsValue(!0))),[e]);return r.jsxs(ee,{label:"Vertrag",suffix:"allgemeines",children:[n?r.jsx("b",{children:"Vor dem generieren musst Du speichern!"}):null,r.jsxs(E,{children:[r.jsx(m,{span:9,children:r.jsx(ye,{label:"Art",name:["vertrag","art"],options:xn.arten})}),r.jsx(m,{span:9,children:r.jsx(H.Item,{label:r.jsx("b",{children:"Sprache:"}),name:["vertrag","sprache"],children:r.jsx(pt,{options:de(xn.sprachen,l=>({label:l,value:l}))})})}),r.jsx(m,{span:6,children:r.jsx(H.Item,{label:" ",children:r.jsx(Lt,{block:!0,disabled:n||!s||!a,onClick:i,type:"primary",children:"Generieren"})})})]}),r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(ys,{name:["vertrag","datei"],typ:"vertrag"})})}),r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(Ur,{label:r.jsx("b",{children:"Zusatzvereinbarungen:"}),name:["vertrag","zusatzvereinbarungen"]})})})]})}function Bs(){const e=D("changelist",{preserve:!0});return r.jsxs(ee,{label:"Historie",suffix:"allgemeines",uncollapsed:!0,children:[r.jsx("h3",{children:'Obsolet, jetzt im Menu "Mehr... : Änderungsverlauf"'}),de(e,(t,n)=>r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsxs("details",{children:[r.jsxs("summary",{children:[t.zeitpunkt," ",t.bearbeiter]}),r.jsx("pre",{children:t.diff})]})})},n))]})}function Ls(){const{optionen:e}=W(),t=D("changelist",{preserve:!0});return r.jsxs(E,{children:[r.jsxs(m,{lg:12,xs:24,children:[r.jsx(Ps,{}),r.jsx(Fs,{}),r.jsx(js,{})]}),r.jsxs(m,{lg:12,xs:24,children:[r.jsx(ks,{}),r.jsx(Vn,{kontakte:e.agenturen,selector:"agentur",children:r.jsx(E,{children:r.jsx(m,{span:12,children:r.jsx(P,{decimals:2,label:"Provision",name:["kosten","provisionAgentur"],suffix:"€"})})})}),r.jsx(Ks,{}),!!(t!=null&&t.length)&&r.jsx(Bs,{})]})]})}const bt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Pe(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Gt(e){return"nodeType"in e}function L(e){var t,n;return e?Pe(e)?e:Gt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Vt(e){const{Document:t}=L(e);return e instanceof t}function Ze(e){return Pe(e)?!1:e instanceof L(e).HTMLElement}function Wn(e){return e instanceof L(e).SVGElement}function Ne(e){return e?Pe(e)?e.document:Gt(e)?Vt(e)?e:Ze(e)||Wn(e)?e.ownerDocument:document:document:document}const he=bt?o.useLayoutEffect:o.useEffect;function xt(e){const t=o.useRef(e);return he(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function Hs(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ye(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return he(()=>{n.current!==e&&(n.current=e)},t),n}function Qe(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function ct(e){const t=xt(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function ut(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Tt={};function vt(e,t){return o.useMemo(()=>{if(t)return t;const n=Tt[e]==null?0:Tt[e]+1;return Tt[e]=n,e+"-"+n},[e,t])}function Yn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,l)=>{const c=Object.entries(l);for(const[u,d]of c){const h=i[u];h!=null&&(i[u]=h+e*d)}return i},{...t})}}const Oe=Yn(1),dt=Yn(-1);function $s(e){return"clientX"in e&&"clientY"in e}function Wt(e){if(!e)return!1;const{KeyboardEvent:t}=L(e.target);return t&&e instanceof t}function Gs(e){if(!e)return!1;const{TouchEvent:t}=L(e.target);return t&&e instanceof t}function ht(e){if(Gs(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return $s(e)?{x:e.clientX,y:e.clientY}:null}const Xe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Xe.Translate.toString(e),Xe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),yn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Vs(e){return e.matches(yn)?e:e.querySelector(yn)}const Ws={display:"none"};function Ys(e){let{id:t,value:n}=e;return z.createElement("div",{id:t,style:Ws},n)}function Xs(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return z.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Js(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Xn=o.createContext(null);function qs(e){const t=o.useContext(Xn);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function _s(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:i}=s;e.forEach(l=>{var c;return(c=l[a])==null?void 0:c.call(l,i)})},[e]),t]}const Zs={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Qs={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ea(e){let{announcements:t=Qs,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=Zs}=e;const{announce:i,announcement:l}=Js(),c=vt("DndLiveRegion"),[u,d]=o.useState(!1);if(o.useEffect(()=>{d(!0)},[]),qs(o.useMemo(()=>({onDragStart(f){let{active:g}=f;i(t.onDragStart({active:g}))},onDragMove(f){let{active:g,over:p}=f;t.onDragMove&&i(t.onDragMove({active:g,over:p}))},onDragOver(f){let{active:g,over:p}=f;i(t.onDragOver({active:g,over:p}))},onDragEnd(f){let{active:g,over:p}=f;i(t.onDragEnd({active:g,over:p}))},onDragCancel(f){let{active:g,over:p}=f;i(t.onDragCancel({active:g,over:p}))}}),[i,t])),!u)return null;const h=z.createElement(z.Fragment,null,z.createElement(Ys,{id:s,value:a.draggable}),z.createElement(Xs,{id:c,announcement:l}));return n?Be.createPortal(h,n):h}var N;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(N||(N={}));function ft(){}const Q=Object.freeze({x:0,y:0});function ta(e,t){const n=ht(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function na(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function ra(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function sa(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=a-s,c=i-n;if(s<a&&n<i){const u=t.width*t.height,d=e.width*e.height,h=l*c,f=h/(u+d-h);return Number(f.toFixed(4))}return 0}const aa=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const i of s){const{id:l}=i,c=n.get(l);if(c){const u=sa(c,t);u>0&&a.push({id:l,data:{droppableContainer:i,value:u}})}}return a.sort(na)};function ia(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Jn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Q}function oa(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const la=oa(1);function qn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ca(e,t,n){const s=qn(t);if(!s)return e;const{scaleX:a,scaleY:i,x:l,y:c}=s,u=e.left-l-(1-a)*parseFloat(n),d=e.top-c-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),h=a?e.width/a:e.width,f=i?e.height/i:e.height;return{width:h,height:f,top:d,right:u+h,bottom:d+f,left:u}}const ua={ignoreTransform:!1};function et(e,t){t===void 0&&(t=ua);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:h}=L(e).getComputedStyle(e);d&&(n=ca(n,d,h))}const{top:s,left:a,width:i,height:l,bottom:c,right:u}=n;return{top:s,left:a,width:i,height:l,bottom:c,right:u}}function jn(e){return et(e,{ignoreTransform:!0})}function da(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ha(e,t){return t===void 0&&(t=L(e).getComputedStyle(e)),t.position==="fixed"}function fa(e,t){t===void 0&&(t=L(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function Yt(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(Vt(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Ze(a)||Wn(a)||n.includes(a))return n;const i=L(e).getComputedStyle(a);return a!==e&&fa(a,i)&&n.push(a),ha(a,i)?n:s(a.parentNode)}return e?s(e):n}function _n(e){const[t]=Yt(e,1);return t??null}function Mt(e){return!bt||!e?null:Pe(e)?e:Gt(e)?Vt(e)||e===Ne(e).scrollingElement?window:Ze(e)?e:null:null}function Zn(e){return Pe(e)?e.scrollX:e.scrollLeft}function Qn(e){return Pe(e)?e.scrollY:e.scrollTop}function Ut(e){return{x:Zn(e),y:Qn(e)}}var I;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(I||(I={}));function er(e){return!bt||!e?!1:e===document.scrollingElement}function tr(e){const t={x:0,y:0},n=er(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:l,isRight:c,maxScroll:s,minScroll:t}}const ga={x:.2,y:.2};function pa(e,t,n,s,a){let{top:i,left:l,right:c,bottom:u}=n;s===void 0&&(s=10),a===void 0&&(a=ga);const{isTop:d,isBottom:h,isLeft:f,isRight:g}=tr(e),p={x:0,y:0},x={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!d&&i<=t.top+b.height?(p.y=I.Backward,x.y=s*Math.abs((t.top+b.height-i)/b.height)):!h&&u>=t.bottom-b.height&&(p.y=I.Forward,x.y=s*Math.abs((t.bottom-b.height-u)/b.height)),!g&&c>=t.right-b.width?(p.x=I.Forward,x.x=s*Math.abs((t.right-b.width-c)/b.width)):!f&&l<=t.left+b.width&&(p.x=I.Backward,x.x=s*Math.abs((t.left+b.width-l)/b.width)),{direction:p,speed:x}}function ma(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function nr(e){return e.reduce((t,n)=>Oe(t,Ut(n)),Q)}function ba(e){return e.reduce((t,n)=>t+Zn(n),0)}function xa(e){return e.reduce((t,n)=>t+Qn(n),0)}function rr(e,t){if(t===void 0&&(t=et),!e)return;const{top:n,left:s,bottom:a,right:i}=t(e);_n(e)&&(a<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const va=[["x",["left","right"],ba],["y",["top","bottom"],xa]];class Xt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Yt(n),a=nr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,c]of va)for(const u of l)Object.defineProperty(this,u,{get:()=>{const d=c(s),h=a[i]-d;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class $e{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function ya(e){const{EventTarget:t}=L(e);return e instanceof t?e:Ne(e)}function At(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var X;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(X||(X={}));function kn(e){e.preventDefault()}function ja(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const sr={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},ka=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return{...n,x:n.x+25};case T.Left:return{...n,x:n.x-25};case T.Down:return{...n,y:n.y+25};case T.Up:return{...n,y:n.y-25}}};class ar{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new $e(Ne(n)),this.windowListeners=new $e(L(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(X.Resize,this.handleCancel),this.windowListeners.add(X.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(X.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&rr(s),n(Q)}handleKeyDown(t){if(Wt(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:i=sr,coordinateGetter:l=ka,scrollBehavior:c="smooth"}=a,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=s.current,h=d?{x:d.left,y:d.top}:Q;this.referenceCoordinates||(this.referenceCoordinates=h);const f=l(t,{active:n,context:s.current,currentCoordinates:h});if(f){const g=dt(f,h),p={x:0,y:0},{scrollableAncestors:x}=s.current;for(const b of x){const y=t.code,{isTop:v,isRight:w,isLeft:k,isBottom:M,maxScroll:S,minScroll:R}=tr(b),j=ma(b),C={x:Math.min(y===T.Right?j.right-j.width/2:j.right,Math.max(y===T.Right?j.left:j.left+j.width/2,f.x)),y:Math.min(y===T.Down?j.bottom-j.height/2:j.bottom,Math.max(y===T.Down?j.top:j.top+j.height/2,f.y))},A=y===T.Right&&!w||y===T.Left&&!k,F=y===T.Down&&!M||y===T.Up&&!v;if(A&&C.x!==f.x){const O=b.scrollLeft+g.x,oe=y===T.Right&&O<=S.x||y===T.Left&&O>=R.x;if(oe&&!g.y){b.scrollTo({left:O,behavior:c});return}oe?p.x=b.scrollLeft-O:p.x=y===T.Right?b.scrollLeft-S.x:b.scrollLeft-R.x,p.x&&b.scrollBy({left:-p.x,behavior:c});break}else if(F&&C.y!==f.y){const O=b.scrollTop+g.y,oe=y===T.Down&&O<=S.y||y===T.Up&&O>=R.y;if(oe&&!g.x){b.scrollTo({top:O,behavior:c});return}oe?p.y=b.scrollTop-O:p.y=y===T.Down?b.scrollTop-S.y:b.scrollTop-R.y,p.y&&b.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,Oe(dt(f,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ar.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=sr,onActivation:a}=t,{active:i}=n;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function wn(e){return!!(e&&"distance"in e)}function En(e){return!!(e&&"delay"in e)}class Jt{constructor(t,n,s){var a;s===void 0&&(s=ya(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:l}=i;this.props=t,this.events=n,this.document=Ne(l),this.documentListeners=new $e(this.document),this.listeners=new $e(s),this.windowListeners=new $e(L(l)),this.initialCoordinates=(a=ht(i))!=null?a:Q,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(X.Resize,this.handleCancel),this.windowListeners.add(X.DragStart,kn),this.windowListeners.add(X.VisibilityChange,this.handleCancel),this.windowListeners.add(X.ContextMenu,kn),this.documentListeners.add(X.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(En(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(wn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(X.Click,ja,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(X.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:l,options:{activationConstraint:c}}=i;if(!a)return;const u=(n=ht(t))!=null?n:Q,d=dt(a,u);if(!s&&c){if(wn(c)){if(c.tolerance!=null&&At(d,c.tolerance))return this.handleCancel();if(At(d,c.distance))return this.handleStart()}if(En(c)&&At(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}t.cancelable&&t.preventDefault(),l(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const wa={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ir extends Jt{constructor(t){const{event:n}=t,s=Ne(n.target);super(t,wa,s)}}ir.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Ea={move:{name:"mousemove"},end:{name:"mouseup"}};var Kt;(function(e){e[e.RightClick=2]="RightClick"})(Kt||(Kt={}));class Ca extends Jt{constructor(t){super(t,Ea,Ne(t.event.target))}}Ca.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Kt.RightClick?!1:(s==null||s({event:n}),!0)}}];const zt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Sa extends Jt{constructor(t){super(t,zt)}static setup(){return window.addEventListener(zt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(zt.move.name,t)};function t(){}}}Sa.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var Ge;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ge||(Ge={}));var gt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(gt||(gt={}));function Da(e){let{acceleration:t,activator:n=Ge.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:l=5,order:c=gt.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:h,delta:f,threshold:g}=e;const p=Ta({delta:f,disabled:!i}),[x,b]=Hs(),y=o.useRef({x:0,y:0}),v=o.useRef({x:0,y:0}),w=o.useMemo(()=>{switch(n){case Ge.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Ge.DraggableRect:return a}},[n,a,u]),k=o.useRef(null),M=o.useCallback(()=>{const R=k.current;if(!R)return;const j=y.current.x*v.current.x,C=y.current.y*v.current.y;R.scrollBy(j,C)},[]),S=o.useMemo(()=>c===gt.TreeOrder?[...d].reverse():d,[c,d]);o.useEffect(()=>{if(!i||!d.length||!w){b();return}for(const R of S){if((s==null?void 0:s(R))===!1)continue;const j=d.indexOf(R),C=h[j];if(!C)continue;const{direction:A,speed:F}=pa(R,C,w,t,g);for(const O of["x","y"])p[O][A[O]]||(F[O]=0,A[O]=0);if(F.x>0||F.y>0){b(),k.current=R,x(M,l),y.current=F,v.current=A;return}}y.current={x:0,y:0},v.current={x:0,y:0},b()},[t,M,s,b,i,l,JSON.stringify(w),JSON.stringify(p),x,d,S,h,JSON.stringify(g)])}const Ra={x:{[I.Backward]:!1,[I.Forward]:!1},y:{[I.Backward]:!1,[I.Forward]:!1}};function Ta(e){let{delta:t,disabled:n}=e;const s=ut(t);return Qe(a=>{if(n||!s||!a)return Ra;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[I.Backward]:a.x[I.Backward]||i.x===-1,[I.Forward]:a.x[I.Forward]||i.x===1},y:{[I.Backward]:a.y[I.Backward]||i.y===-1,[I.Forward]:a.y[I.Forward]||i.y===1}}},[n,t,s])}function Ma(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Qe(a=>{var i;return t==null?null:(i=s??a)!=null?i:null},[s,t])}function Aa(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,i=a.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,s)}));return[...n,...i]},[]),[e,t])}var Je;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Je||(Je={}));var Bt;(function(e){e.Optimized="optimized"})(Bt||(Bt={}));const Cn=new Map;function za(e,t){let{dragging:n,dependencies:s,config:a}=t;const[i,l]=o.useState(null),{frequency:c,measure:u,strategy:d}=a,h=o.useRef(e),f=y(),g=Ye(f),p=o.useCallback(function(v){v===void 0&&(v=[]),!g.current&&l(w=>w===null?v:w.concat(v.filter(k=>!w.includes(k))))},[g]),x=o.useRef(null),b=Qe(v=>{if(f&&!n)return Cn;if(!v||v===Cn||h.current!==e||i!=null){const w=new Map;for(let k of e){if(!k)continue;if(i&&i.length>0&&!i.includes(k.id)&&k.rect.current){w.set(k.id,k.rect.current);continue}const M=k.node.current,S=M?new Xt(u(M),M):null;k.rect.current=S,S&&w.set(k.id,S)}return w}return v},[e,i,n,f,u]);return o.useEffect(()=>{h.current=e},[e]),o.useEffect(()=>{f||p()},[n,f]),o.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),o.useEffect(()=>{f||typeof c!="number"||x.current!==null||(x.current=setTimeout(()=>{p(),x.current=null},c))},[c,f,p,...s]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:i!=null};function y(){switch(d){case Je.Always:return!1;case Je.BeforeDragging:return n;default:return!n}}}function qt(e,t){return Qe(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Oa(e,t){return qt(e,t)}function Pa(e){let{callback:t,disabled:n}=e;const s=xt(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function yt(e){let{callback:t,disabled:n}=e;const s=xt(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Na(e){return new Xt(et(e),e)}function Sn(e,t,n){t===void 0&&(t=Na);const[s,a]=o.useState(null);function i(){a(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const l=Pa({callback(u){if(e)for(const d of u){const{type:h,target:f}=d;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),c=yt({callback:i});return he(()=>{i(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),s}function Ia(e){const t=qt(e);return Jn(e,t)}const Dn=[];function Fa(e){const t=o.useRef(e),n=Qe(s=>e?s&&s!==Dn&&e&&t.current&&e.parentNode===t.current.parentNode?s:Yt(e):Dn,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function Ua(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(i=>{const l=Mt(i.target);l&&n(c=>c?(c.set(l,Ut(l)),new Map(c)):null)},[]);return o.useEffect(()=>{const i=s.current;if(e!==i){l(i);const c=e.map(u=>{const d=Mt(u);return d?(d.addEventListener("scroll",a,{passive:!0}),[d,Ut(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(i)};function l(c){c.forEach(u=>{const d=Mt(u);d==null||d.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>Oe(i,l),Q):nr(e):Q,[e,t])}function Rn(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==Q;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?dt(e,n.current):Q}function Ka(e){o.useEffect(()=>{if(!bt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ba(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:i}=s;return n[a]=l=>{i(l,t)},n},{}),[e,t])}function or(e){return o.useMemo(()=>e?da(e):null,[e])}const Tn=[];function La(e,t){t===void 0&&(t=et);const[n]=e,s=or(n?L(n):null),[a,i]=o.useState(Tn);function l(){i(()=>e.length?e.map(u=>er(u)?s:new Xt(t(u),u)):Tn)}const c=yt({callback:l});return he(()=>{c==null||c.disconnect(),l(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),a}function lr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ze(t)?t:e}function Ha(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(d=>{for(const{target:h}of d)if(Ze(h)){s(f=>{const g=t(h);return f?{...f,width:g.width,height:g.height}:g});break}},[t]),i=yt({callback:a}),l=o.useCallback(d=>{const h=lr(d);i==null||i.disconnect(),h&&(i==null||i.observe(h)),s(h?t(h):null)},[t,i]),[c,u]=ct(l);return o.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const $a=[{sensor:ir,options:{}},{sensor:ar,options:{}}],Ga={current:{}},it={draggable:{measure:jn},droppable:{measure:jn,strategy:Je.WhileDragging,frequency:Bt.Optimized},dragOverlay:{measure:et}};class Ve extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Va={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ve,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:it,measureDroppableContainers:ft,windowRect:null,measuringScheduled:!1},cr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ft,draggableNodes:new Map,over:null,measureDroppableContainers:ft},tt=o.createContext(cr),ur=o.createContext(Va);function Wa(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ve}}}function Ya(e,t){switch(t.type){case N.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case N.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case N.DragEnd:case N.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case N.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new Ve(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case N.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const l=new Ve(e.droppable.containers);return l.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case N.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const i=new Ve(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Xa(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(tt),i=ut(s),l=ut(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&i&&l!=null){if(!Wt(i)||document.activeElement===i.target)return;const c=a.get(l);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[u.current,d.current]){if(!h)continue;const f=Vs(h);if(f){f.focus();break}}})}},[s,t,a,l,i]),null}function dr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),n):n}function Ja(e){return o.useMemo(()=>({draggable:{...it.draggable,...e==null?void 0:e.draggable},droppable:{...it.droppable,...e==null?void 0:e.droppable},dragOverlay:{...it.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function qa(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const i=o.useRef(!1),{x:l,y:c}=typeof a=="boolean"?{x:a,y:a}:a;he(()=>{if(!l&&!c||!t){i.current=!1;return}if(i.current||!s)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const h=n(d),f=Jn(h,s);if(l||(f.x=0),c||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const g=_n(d);g&&g.scrollBy({top:f.y,left:f.x})}},[t,l,c,s,n])}const jt=o.createContext({...Q,scaleX:1,scaleY:1});var ve;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ve||(ve={}));const _a=o.memo(function(t){var n,s,a,i;let{id:l,accessibility:c,autoScroll:u=!0,children:d,sensors:h=$a,collisionDetection:f=aa,measuring:g,modifiers:p,...x}=t;const b=o.useReducer(Ya,void 0,Wa),[y,v]=b,[w,k]=_s(),[M,S]=o.useState(ve.Uninitialized),R=M===ve.Initialized,{draggable:{active:j,nodes:C,translate:A},droppable:{containers:F}}=y,O=j!=null?C.get(j):null,oe=o.useRef({initial:null,translated:null}),le=o.useMemo(()=>{var B;return j!=null?{id:j,data:(B=O==null?void 0:O.data)!=null?B:Ga,rect:oe}:null},[j,O]),fe=o.useRef(null),[en,tn]=o.useState(null),[ce,nn]=o.useState(null),ke=Ye(x,Object.values(x)),kt=vt("DndDescribedBy",l),rn=o.useMemo(()=>F.getEnabled(),[F]),we=Ja(g),{droppableRects:De,measureDroppableContainers:nt,measuringScheduled:sn}=za(rn,{dragging:R,dependencies:[A.x,A.y],config:we.droppable}),_=Ma(C,j),an=o.useMemo(()=>ce?ht(ce):null,[ce]),on=Dr(),ln=Oa(_,we.draggable.measure);qa({activeNode:j!=null?C.get(j):null,config:on.layoutShiftCompensation,initialRect:ln,measure:we.draggable.measure});const Z=Sn(_,we.draggable.measure,ln),wt=Sn(_?_.parentElement:null),Ee=o.useRef({activatorEvent:null,active:null,activeNode:_,collisionRect:null,collisions:null,droppableRects:De,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),cn=F.getNodeFor((n=Ee.current.over)==null?void 0:n.id),Ce=Ha({measure:we.dragOverlay.measure}),rt=(s=Ce.nodeRef.current)!=null?s:_,Re=R?(a=Ce.rect)!=null?a:Z:null,un=!!(Ce.nodeRef.current&&Ce.rect),dn=Ia(un?null:Z),Et=or(rt?L(rt):null),ge=Fa(R?cn??_:null),st=La(ge),at=dr(p,{transform:{x:A.x-dn.x,y:A.y-dn.y,scaleX:1,scaleY:1},activatorEvent:ce,active:le,activeNodeRect:Z,containerNodeRect:wt,draggingNodeRect:Re,over:Ee.current.over,overlayNodeRect:Ce.rect,scrollableAncestors:ge,scrollableAncestorRects:st,windowRect:Et}),hn=an?Oe(an,A):null,fn=Ua(ge),yr=Rn(fn),jr=Rn(fn,[Z]),Te=Oe(at,yr),Me=Re?la(Re,at):null,Ie=le&&Me?f({active:le,collisionRect:Me,droppableRects:De,droppableContainers:rn,pointerCoordinates:hn}):null,gn=ra(Ie,"id"),[pe,pn]=o.useState(null),kr=un?at:Oe(at,jr),wr=ia(kr,(i=pe==null?void 0:pe.rect)!=null?i:null,Z),Ct=o.useRef(null),mn=o.useCallback((B,$)=>{let{sensor:G,options:me}=$;if(fe.current==null)return;const Y=C.get(fe.current);if(!Y)return;const V=B.nativeEvent,te=new G({active:fe.current,activeNode:Y,event:V,options:me,context:Ee,onAbort(U){if(!C.get(U))return;const{onDragAbort:ne}=ke.current,ue={id:U};ne==null||ne(ue),w({type:"onDragAbort",event:ue})},onPending(U,be,ne,ue){if(!C.get(U))return;const{onDragPending:Ue}=ke.current,xe={id:U,constraint:be,initialCoordinates:ne,offset:ue};Ue==null||Ue(xe),w({type:"onDragPending",event:xe})},onStart(U){const be=fe.current;if(be==null)return;const ne=C.get(be);if(!ne)return;const{onDragStart:ue}=ke.current,Fe={activatorEvent:V,active:{id:be,data:ne.data,rect:oe}};Be.unstable_batchedUpdates(()=>{ue==null||ue(Fe),S(ve.Initializing),v({type:N.DragStart,initialCoordinates:U,active:be}),w({type:"onDragStart",event:Fe}),tn(Ct.current),nn(V)})},onMove(U){v({type:N.DragMove,coordinates:U})},onEnd:Ae(N.DragEnd),onCancel:Ae(N.DragCancel)});Ct.current=te;function Ae(U){return async function(){const{active:ne,collisions:ue,over:Fe,scrollAdjustedTranslate:Ue}=Ee.current;let xe=null;if(ne&&Ue){const{cancelDrop:Ke}=ke.current;xe={activatorEvent:V,active:ne,collisions:ue,delta:Ue,over:Fe},U===N.DragEnd&&typeof Ke=="function"&&await Promise.resolve(Ke(xe))&&(U=N.DragCancel)}fe.current=null,Be.unstable_batchedUpdates(()=>{v({type:U}),S(ve.Uninitialized),pn(null),tn(null),nn(null),Ct.current=null;const Ke=U===N.DragEnd?"onDragEnd":"onDragCancel";if(xe){const St=ke.current[Ke];St==null||St(xe),w({type:Ke,event:xe})}})}}},[C]),Er=o.useCallback((B,$)=>(G,me)=>{const Y=G.nativeEvent,V=C.get(me);if(fe.current!==null||!V||Y.dndKit||Y.defaultPrevented)return;const te={active:V};B(G,$.options,te)===!0&&(Y.dndKit={capturedBy:$.sensor},fe.current=me,mn(G,$))},[C,mn]),bn=Aa(h,Er);Ka(h),he(()=>{Z&&M===ve.Initializing&&S(ve.Initialized)},[Z,M]),o.useEffect(()=>{const{onDragMove:B}=ke.current,{active:$,activatorEvent:G,collisions:me,over:Y}=Ee.current;if(!$||!G)return;const V={active:$,activatorEvent:G,collisions:me,delta:{x:Te.x,y:Te.y},over:Y};Be.unstable_batchedUpdates(()=>{B==null||B(V),w({type:"onDragMove",event:V})})},[Te.x,Te.y]),o.useEffect(()=>{const{active:B,activatorEvent:$,collisions:G,droppableContainers:me,scrollAdjustedTranslate:Y}=Ee.current;if(!B||fe.current==null||!$||!Y)return;const{onDragOver:V}=ke.current,te=me.get(gn),Ae=te&&te.rect.current?{id:te.id,rect:te.rect.current,data:te.data,disabled:te.disabled}:null,U={active:B,activatorEvent:$,collisions:G,delta:{x:Y.x,y:Y.y},over:Ae};Be.unstable_batchedUpdates(()=>{pn(Ae),V==null||V(U),w({type:"onDragOver",event:U})})},[gn]),he(()=>{Ee.current={activatorEvent:ce,active:le,activeNode:_,collisionRect:Me,collisions:Ie,droppableRects:De,draggableNodes:C,draggingNode:rt,draggingNodeRect:Re,droppableContainers:F,over:pe,scrollableAncestors:ge,scrollAdjustedTranslate:Te},oe.current={initial:Re,translated:Me}},[le,_,Ie,Me,C,rt,Re,De,F,pe,ge,Te]),Da({...on,delta:A,draggingRect:Me,pointerCoordinates:hn,scrollableAncestors:ge,scrollableAncestorRects:st});const Cr=o.useMemo(()=>({active:le,activeNode:_,activeNodeRect:Z,activatorEvent:ce,collisions:Ie,containerNodeRect:wt,dragOverlay:Ce,draggableNodes:C,droppableContainers:F,droppableRects:De,over:pe,measureDroppableContainers:nt,scrollableAncestors:ge,scrollableAncestorRects:st,measuringConfiguration:we,measuringScheduled:sn,windowRect:Et}),[le,_,Z,ce,Ie,wt,Ce,C,F,De,pe,nt,ge,st,we,sn,Et]),Sr=o.useMemo(()=>({activatorEvent:ce,activators:bn,active:le,activeNodeRect:Z,ariaDescribedById:{draggable:kt},dispatch:v,draggableNodes:C,over:pe,measureDroppableContainers:nt}),[ce,bn,le,Z,v,kt,C,pe,nt]);return z.createElement(Xn.Provider,{value:k},z.createElement(tt.Provider,{value:Sr},z.createElement(ur.Provider,{value:Cr},z.createElement(jt.Provider,{value:wr},d)),z.createElement(Xa,{disabled:(c==null?void 0:c.restoreFocus)===!1})),z.createElement(ea,{...c,hiddenTextDescribedById:kt}));function Dr(){const B=(en==null?void 0:en.autoScrollEnabled)===!1,$=typeof u=="object"?u.enabled===!1:u===!1,G=R&&!B&&!$;return typeof u=="object"?{...u,enabled:G}:{enabled:G}}}),Za=o.createContext(null),Mn="button",Qa="Draggable";function hr(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const i=vt(Qa),{activators:l,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:h,draggableNodes:f,over:g}=o.useContext(tt),{role:p=Mn,roleDescription:x="draggable",tabIndex:b=0}=a??{},y=(u==null?void 0:u.id)===t,v=o.useContext(y?jt:Za),[w,k]=ct(),[M,S]=ct(),R=Ba(l,t),j=Ye(n);he(()=>(f.set(t,{id:t,key:i,node:w,activatorNode:M,data:j}),()=>{const A=f.get(t);A&&A.key===i&&f.delete(t)}),[f,t]);const C=o.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":s,"aria-pressed":y&&p===Mn?!0:void 0,"aria-roledescription":x,"aria-describedby":h.draggable}),[s,p,b,y,x,h.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:C,isDragging:y,listeners:s?void 0:R,node:w,over:g,setNodeRef:k,setActivatorNodeRef:S,transform:v}}function ei(){return o.useContext(ur)}const ti="Droppable",ni={timeout:25};function fr(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const i=vt(ti),{active:l,dispatch:c,over:u,measureDroppableContainers:d}=o.useContext(tt),h=o.useRef({disabled:n}),f=o.useRef(!1),g=o.useRef(null),p=o.useRef(null),{disabled:x,updateMeasurementsFor:b,timeout:y}={...ni,...a},v=Ye(b??s),w=o.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(v.current)?v.current:[v.current]),p.current=null},y)},[y]),k=yt({callback:w,disabled:x||!l}),M=o.useCallback((C,A)=>{k&&(A&&(k.unobserve(A),f.current=!1),C&&k.observe(C))},[k]),[S,R]=ct(M),j=Ye(t);return o.useEffect(()=>{!k||!S.current||(k.disconnect(),f.current=!1,k.observe(S.current))},[S,k]),o.useEffect(()=>(c({type:N.RegisterDroppable,element:{id:s,key:i,disabled:n,node:S,rect:g,data:j}}),()=>c({type:N.UnregisterDroppable,key:i,id:s})),[s]),o.useEffect(()=>{n!==h.current.disabled&&(c({type:N.SetDroppableDisabled,id:s,key:i,disabled:n}),h.current.disabled=n)},[s,i,n,c]),{active:l,rect:g,isOver:(u==null?void 0:u.id)===s,node:S,over:u,setNodeRef:R}}function ri(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[i,l]=o.useState(null),c=ut(n);return!n&&!s&&c&&a(c),he(()=>{if(!i)return;const u=s==null?void 0:s.key,d=s==null?void 0:s.props.id;if(u==null||d==null){a(null);return}Promise.resolve(t(d,i)).then(()=>{a(null)})},[t,s,i]),z.createElement(z.Fragment,null,n,s?o.cloneElement(s,{ref:l}):null)}const si={x:0,y:0,scaleX:1,scaleY:1};function ai(e){let{children:t}=e;return z.createElement(tt.Provider,{value:cr},z.createElement(jt.Provider,{value:si},t))}const ii={position:"fixed",touchAction:"none"},oi=e=>Wt(e)?"transform 250ms ease":void 0,li=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:i,className:l,rect:c,style:u,transform:d,transition:h=oi}=e;if(!c)return null;const f=a?d:{...d,scaleX:1,scaleY:1},g={...ii,width:c.width,height:c.height,top:c.top,left:c.left,transform:Xe.Transform.toString(f),transformOrigin:a&&s?ta(s,c):void 0,transition:typeof h=="function"?h(s):h,...u};return z.createElement(n,{className:l,style:g,ref:t},i)}),ci=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:i,className:l}=e;if(i!=null&&i.active)for(const[c,u]of Object.entries(i.active))u!==void 0&&(a[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(i!=null&&i.dragOverlay)for(const[c,u]of Object.entries(i.dragOverlay))u!==void 0&&s.node.style.setProperty(c,u);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&s.node.classList.add(l.dragOverlay),function(){for(const[u,d]of Object.entries(a))n.node.style.setProperty(u,d);l!=null&&l.active&&n.node.classList.remove(l.active)}},ui=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Xe.Transform.toString(t)},{transform:Xe.Transform.toString(n)}]},di={duration:250,easing:"ease",keyframes:ui,sideEffects:ci({styles:{active:{opacity:"0"}}})};function hi(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return xt((i,l)=>{if(t===null)return;const c=n.get(i);if(!c)return;const u=c.node.current;if(!u)return;const d=lr(l);if(!d)return;const{transform:h}=L(l).getComputedStyle(l),f=qn(h);if(!f)return;const g=typeof t=="function"?t:fi(t);return rr(u,a.draggable.measure),g({active:{id:i,data:c.data,node:u,rect:a.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:l,rect:a.dragOverlay.measure(d)},droppableContainers:s,measuringConfiguration:a,transform:f})})}function fi(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...di,...e};return i=>{let{active:l,dragOverlay:c,transform:u,...d}=i;if(!t)return;const h={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},f={scaleX:u.scaleX!==1?l.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?l.rect.height*u.scaleY/c.rect.height:1},g={x:u.x-h.x,y:u.y-h.y,...f},p=a({...d,active:l,dragOverlay:c,transform:{initial:u,final:g}}),[x]=p,b=p[p.length-1];if(JSON.stringify(x)===JSON.stringify(b))return;const y=s==null?void 0:s({active:l,dragOverlay:c,...d}),v=c.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{v.onfinish=()=>{y==null||y(),w()}})}}let An=0;function gi(e){return o.useMemo(()=>{if(e!=null)return An++,An},[e])}const pi=z.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:i,modifiers:l,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:h,active:f,activeNodeRect:g,containerNodeRect:p,draggableNodes:x,droppableContainers:b,dragOverlay:y,over:v,measuringConfiguration:w,scrollableAncestors:k,scrollableAncestorRects:M,windowRect:S}=ei(),R=o.useContext(jt),j=gi(f==null?void 0:f.id),C=dr(l,{activatorEvent:h,active:f,activeNodeRect:g,containerNodeRect:p,draggingNodeRect:y.rect,over:v,overlayNodeRect:y.rect,scrollableAncestors:k,scrollableAncestorRects:M,transform:R,windowRect:S}),A=qt(g),F=hi({config:s,draggableNodes:x,droppableContainers:b,measuringConfiguration:w}),O=A?y.setRef:void 0;return z.createElement(ai,null,z.createElement(ri,{animation:F},f&&j?z.createElement(li,{key:j,id:f.id,ref:O,as:c,activatorEvent:h,adjustScale:t,className:u,transition:i,rect:A,style:{zIndex:d,...a},transform:C},n):null))}),_t={BOX:"box",SourceElement:"source-element"},mi={border:"0.2px solid gray",backgroundColor:"white"};function gr({item:e,degree:t,setDegree:n,level:s,setLevel:a}){const i=o.useCallback(c=>{e.degree=c,n(c)},[e,n]),l=o.useCallback(c=>{e.level=c.target.value,a(e.level)},[e,a]);return r.jsxs(ze,{style:{minWidth:400},children:[r.jsxs(m,{span:12,children:[r.jsx("b",{children:"Drehen:"}),r.jsx(It,{max:359,min:0,onChange:i,value:t})]}),r.jsxs(m,{span:12,children:[r.jsx("b",{children:"Ebene:"}),r.jsx(Lr.Group,{buttonStyle:"solid",onChange:l,optionType:"button",options:[{label:"unten",value:0},{label:"mitte",value:1},{label:"oben",value:2}],value:s})]})]})}function bi({item:e,comment:t,setComment:n,degree:s,setDegree:a,level:i,setLevel:l}){var u;const c=o.useCallback(d=>{e.comment=d.target.value,n(e.comment)},[e,n]);return r.jsxs(r.Fragment,{children:[e.photo?r.jsx("div",{children:r.jsx("img",{alt:"Popup Photo",src:`/riderimg/${(u=e.photo)==null?void 0:u.src}`})}):null,r.jsx("b",{children:"Kommentar:"}),r.jsx(qe,{onChange:c,style:{height:150},value:t}),r.jsx(gr,{degree:s,item:e,level:i,setDegree:a,setLevel:l})]})}function xi({item:e,comment:t,setComment:n,degree:s,setDegree:a,level:i,setLevel:l,title:c,setTitle:u,width:d,setWidth:h,height:f,setHeight:g}){const p=o.useCallback(v=>{e.title=v.target.value,u(e.title)},[e,u]),x=o.useCallback(v=>{e.comment=v.target.value,n(e.comment)},[e,n]),b=o.useCallback(v=>{e.width=v,h(v)},[e,h]),y=o.useCallback(v=>{e.height=v,g(v)},[e,g]);return r.jsxs(r.Fragment,{children:[r.jsx(ze,{children:r.jsxs(m,{span:24,children:[r.jsx("b",{children:"Titel:"}),r.jsx(Br,{onChange:p,value:c})]})}),r.jsx(ze,{children:r.jsxs(m,{span:24,children:[r.jsx("b",{children:"Kommentar:"}),r.jsx(qe,{onChange:x,style:{height:150},value:t})]})}),r.jsxs(ze,{children:[r.jsxs(m,{span:12,children:[r.jsx("b",{children:"Breite:"}),r.jsx(It,{max:150,min:0,onChange:b,value:d})]}),r.jsxs(m,{span:12,children:[r.jsx("b",{children:"Höhe:"}),r.jsx(It,{max:150,min:0,onChange:y,value:f})]})]}),r.jsx(gr,{degree:s,item:e,level:i,setDegree:a,setLevel:l})]})}function pr({item:e,callback:t}){const[n,s]=o.useState(0),[a,i]=o.useState(0),[l,c]=o.useState(0),[u,d]=o.useState(0),[h,f]=o.useState(""),[g,p]=o.useState(""),x=o.useMemo(()=>e.category==="Extra",[e]),b=o.useMemo(()=>({textAlign:"center",fontSize:"10px",lineHeight:`${u}px`}),[u]);return o.useEffect(()=>{s(e.degree),i(e.level||0),c(e.width),d(e.height),f(e.title),p(e.comment||"")},[e]),r.jsx(Kr,{content:x?r.jsx(xi,{comment:g,degree:n,height:u,item:e,level:a,setComment:p,setDegree:s,setHeight:d,setLevel:i,setTitle:f,setWidth:c,title:h,width:l}):r.jsx(bi,{comment:g,degree:n,item:e,level:a,setComment:p,setDegree:s,setLevel:i}),onOpenChange:t,title:h,trigger:"contextMenu",children:r.jsx("div",{style:{...mi,width:l,height:u,rotate:`${n}deg`,zIndex:a,borderRadius:e.isCircle?"50%":0},children:e.img?r.jsx("img",{alt:e.title,height:e.img.height,src:`/riderimg/${e.img.src}`,width:e.img.width}):r.jsx("div",{style:b,children:r.jsx("span",{style:{display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},children:h})})})})}const vi={position:"absolute",cursor:"move"};function yi({item:e,callback:t}){const[n,s]=o.useState(!1),{attributes:a,listeners:i,setNodeRef:l}=hr({id:e.id,data:{type:_t.BOX,item:e},attributes:{tabIndex:-1},disabled:n}),c=o.useCallback(u=>{s(u),u||t()},[t]);return r.jsx("div",{ref:l,style:{...vi,left:e.left,top:e.top},...a,...i,children:r.jsx(pr,{callback:c,item:e})})}const ji={width:800,height:300,border:"1px solid black",position:"relative",backgroundSize:"200px 100px",backgroundPosition:"-2px -2px",backgroundImage:`-webkit-linear-gradient(#EEE 2px, transparent 2px),-webkit-linear-gradient(0, #EEE 2px, transparent 2px)
`};function ki({targetBoxes:e,setTargetBoxes:t}){const{setNodeRef:n}=fr({id:"TargetContainer"}),s=o.useCallback(()=>t(Hr(e)),[t,e]);return r.jsx("div",{style:{width:"100%",overflow:"scroll"},children:r.jsx("div",{ref:n,style:ji,children:de(e,a=>r.jsx(yi,{callback:s,item:a},a.id))})})}function wi({item:e}){const t=o.useMemo(()=>e.category==="Extra",[e.category]),{attributes:n,listeners:s,setNodeRef:a}=hr({id:e.id,data:{type:_t.SourceElement,item:t?{...e,id:e.id,left:0,top:0}:e}});return r.jsx(He.Item,{ref:a,...s,...n,children:r.jsx("div",{style:{width:"100%"},children:r.jsx("div",{style:{width:"100%"},children:e.title})})})}function Ei({sourceBoxes:e}){const t=o.useMemo(()=>de(["Keys","Drums","Bass","Guitar","Extra"],s=>({key:s,label:s==="Drums"?"Drums / Percussion":s,children:r.jsx(Ci,{cat:s,sourceBoxes:e})})),[e]),{setNodeRef:n}=fr({id:"SourceContainer"});return r.jsx($r,{accordion:!0,defaultActiveKey:"Keys",items:t,ref:n})}function Ci({cat:e,sourceBoxes:t}){const n=o.useMemo(()=>ot(t,{category:e}),[t,e]),s=o.useCallback(a=>r.jsx(wi,{item:a}),[]);return r.jsx(He,{bordered:!0,dataSource:n,renderItem:s,size:"small"})}const mr={category:"Extra",id:"Extra Eckig 1",title:"Eigener Inhalt",width:50,height:50,level:1},br={category:"Extra",id:"Extra Rund 2",title:"Runder Inhalt",width:50,height:50,level:1,isCircle:!0},Ot={category:"Drums",id:"DrumsYamaha",title:"Drums (Yamaha)",width:200,height:200,level:0,img:{src:"Drums.png",width:200,height:200}},zn=[{category:"Keys",id:"Flügel",title:"Flügel (Yamaha)",width:150,height:200,level:0,img:{src:"pianoschema.png",width:150,height:200},photo:{src:"yamaha.jpg",width:150,height:200}},{category:"Keys",id:"Klavierbank",title:"Klavierbank",width:65,height:33,level:0,photo:{src:"Bench.png"}},{category:"Keys",id:"Rhodes",title:"Rhodes Mark I",width:115,height:60,level:0,img:{src:"Rhodes.png",width:115},photo:{src:"RhodesMark1.png",width:115}},{category:"Keys",id:"NordStage",title:"Nord Stage 4 compact",width:107,height:32,level:1,img:{src:"Nord.png"},photo:{src:"NordStage.png"}},{...Ot,id:"DrumsYamaha",title:"Drums (Yamaha)"},{...Ot,id:"DrumsGretsch",title:"Drums (Gretsch)"},{...Ot,id:"DrumsCustom",title:"Drums (Eigenes Set)"},{category:"Drums",id:"PercussionSet",title:"Percussion Group",width:150,height:150,level:0,img:{src:"PercussionSet.png",width:150,height:150}},{category:"Bass",id:"Markbass",title:'Bass Amp Markbass 4x10"',width:60,height:48,level:0,photo:{src:"Markbass.png"}},{category:"Bass",id:"GallienKrueger",title:"Bass Amp Gallien-Krueger Combo MB150",width:35,height:22,level:0,photo:{src:"GallienKrueger.png"}},{category:"Guitar",id:"Fender",title:"Fender Twin Reverb",width:68,height:27,level:0,photo:{src:"Fender.png"}},{category:"Guitar",id:"Jazzchorus",title:"Roland Jazzchorus",width:55,height:24,level:0,photo:{src:"Roland.png"}},{category:"Guitar",id:"Polytone 12",title:'Polytone Amp 12"',width:40,height:35,level:0,photo:{src:"Polytone.png"}},mr,br],K=[];for(let e=0;e<256;++e)K.push((e+256).toString(16).slice(1));function Si(e,t=0){return(K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]).toLowerCase()}let Pt;const Di=new Uint8Array(16);function Ri(){if(!Pt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Pt=crypto.getRandomValues.bind(crypto)}return Pt(Di)}const Ti=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),On={randomUUID:Ti};function Pn(e,t,n){var a;if(On.randomUUID&&!e)return On.randomUUID();e=e||{};const s=e.random??((a=e.rng)==null?void 0:a.call(e))??Ri();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Si(s)}function Mi({targetBoxes:e,setTargetBoxes:t}){const[n,s]=o.useState(zn);o.useEffect(()=>{const h=de(e,"id"),f=ot(zn,g=>!h.includes(g.id));ae(f,g=>g.id.startsWith("Extra Eckig"))||f.push({...mr,id:"Extra Eckig"+Pn()}),ae(f,g=>g.id.startsWith("Extra Rund"))||f.push({...br,id:"Extra Rund"+Pn()}),s(f)},[e]);const[a,i]=o.useState(null),l=o.useCallback(h=>{var f;i((f=h.active.data.current)==null?void 0:f.item)},[]),c=o.useCallback(h=>{i(null);const{active:f,over:g,delta:p,activatorEvent:x}=h;if(p.x===0&&p.y===0)return;const{item:b,type:y}=f.data.current??{},v=b.id;if((g==null?void 0:g.id)==="SourceContainer"){t==null||t(Gr(e,{id:v}));return}if((g==null?void 0:g.id)!=="TargetContainer")return;const w=[...e??[]];if(y===_t.SourceElement){const k=x,M=g.rect,S=p.x-(M.left-(k.x-k.offsetX)),R=p.y-(M.top-(k.y-k.offsetY));w.push({...b,left:S,top:R}),t==null||t(w);return}if(ae(w,{id:v})){const k=ae(w,{id:v});k&&(k.left=b.left+p.x,k.top=b.top+p.y,w.splice(w.indexOf(k),1),w.push(k),t==null||t(w))}},[t,e]),u=o.useMemo(()=>ot(e,h=>!!h.comment),[e]),d=o.useCallback(h=>r.jsxs(He.Item,{children:[r.jsx(He.Item.Meta,{title:h.title}),h.comment]}),[]);return r.jsxs(_a,{onDragEnd:c,onDragStart:l,children:[r.jsx(pi,{children:a?r.jsx(pr,{callback:Vr,item:a}):null}),r.jsxs(ze,{gutter:16,children:[r.jsx(m,{span:4,children:r.jsx(Bn,{theme:{components:{Collapse:{contentPadding:0}}},children:r.jsx(Ei,{sourceBoxes:n})})}),r.jsx(m,{span:20,children:r.jsx(ki,{setTargetBoxes:t,targetBoxes:e})})]}),r.jsxs(ze,{gutter:16,children:[r.jsxs(m,{span:8,children:[r.jsx(We.Title,{level:5,children:"Hilfe"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Ziehe Elemente von links nach rechts"}),r.jsx("li",{children:"Zum Entfernen wieder nach links ziehen"}),r.jsx("li",{children:"Rechts kannst Du mit Rechtsklick bearbeiten"}),r.jsx("li",{children:"Speichern nicht vergessen!"})]})]}),r.jsxs(m,{span:16,children:[r.jsx(We.Title,{level:5,children:"Infos"}),r.jsx(He,{dataSource:u,itemLayout:"horizontal",renderItem:d})]})]})]})}function Nt({icon:e,text:t,href:n}){const{sm:s}=Ht();return r.jsx(Lt,{href:n,icon:r.jsx($t,{iconName:e,size:16}),target:"_blank",type:"primary",children:s?t:null})}function Ai(){const{search:e}=Wr(),t=o.useMemo(()=>window.location.href.replace("vue/konzert","rider").replace(e,""),[e]),n=o.useMemo(()=>encodeURIComponent(`Hallo,
unter folgendem Link kannst Du einen Rider erstellen oder bearbeiten:
    
${t}

Hier kannst Du einfach alles, was du brauchst, mit der Maus aus dem Kasten links auf die Bühne ziehen, drehen, positionieren und bei eigenen Sachen beschriften.
Wenn Du was doch nicht brauchst, wieder von der Bühne in den Kasten ziehen.
Die gezeichnete Bühne entspricht unserer Bühnengröße und die Elemente Flügel, Drumset auch ungefähr der realen Größe.

Liebe Grüße,
Dein Jazzclub Team
    `),[t]),s=o.useMemo(()=>t.replace("rider","pdf/rider"),[t]);return r.jsx(ee,{label:"Rider",suffix:"technik",children:r.jsx(E,{children:r.jsxs(m,{span:24,children:[r.jsx(Yr,{buttons:[r.jsx(Nt,{href:s,icon:"Printer",text:"PDF"},"pdf"),r.jsx(Nt,{href:`mailto:?subject=Rider für Jazzclub bearbeiten&body=${n}`,icon:"EnvelopeFill",text:"Als E-Mail..."},"sendrider"),r.jsx(Nt,{href:t,icon:"EyeFill",text:"Vorschau"},"linkrider")],title:""}),r.jsx(H.Item,{name:"riderBoxes",trigger:"setTargetBoxes",valuePropName:"targetBoxes",children:r.jsx(Mi,{})})]})})})}function zi(){return r.jsx(E,{children:r.jsxs(m,{span:24,children:[r.jsx(ws,{fuerVermietung:!1}),r.jsx(Ai,{})]})})}class Zt{constructor(t){this.veranstaltung=t}get kasse(){return this.veranstaltung.kasse}get kosten(){return this.veranstaltung.kosten}get unterkunft(){return this.veranstaltung.unterkunft}get eintrittspreise(){return this.veranstaltung.eintrittspreise}get gema(){return this.erwarteterOderEchterEintritt*.05}get kostenGesamtEUR(){const t=this.veranstaltung.artist.brauchtHotel?this.unterkunft.kostenTotalEUR:0;return this.kosten.totalEUR+t+this.kasse.ausgabenOhneGage+this.gema}get erwarteterOderEchterEintritt(){return(this.kasse.istFreigegeben?this.kasse.einnahmeTicketsEUR:this.eintrittspreise.erwarteterEintritt)+this.kasse.einnahmenReservix}get einnahmenGesamtEUR(){return this.erwarteterOderEchterEintritt}get dealAbsolutEUR(){return Math.max(this.bruttoUeberschussEUR*this.kosten.dealAlsFaktor,0)}get bruttoUeberschussEUR(){return this.einnahmenGesamtEUR-this.kostenGesamtEUR}get dealUeberschussTotal(){return this.bruttoUeberschussEUR-this.dealAbsolutEUR}}function xr(){const e=q(),t=D(["kasse","einnahmenReservix"],{preserve:!0}),n=D("eintrittspreise",{preserve:!0});return o.useMemo(()=>{const s=new ie(e.getFieldsValue(!0)),a=new Zt(s);return s.eintrittspreise.zuschuss+a.erwarteterOderEchterEintritt},[t,n])}const Oi=["eintrittspreise","preisprofil"];function Pi(){const e=q(),{optionen:t}=W(),n=xr(),{istFreigegeben:s}=Ln(),a=D(Oi,{preserve:!0}),i=o.useMemo(()=>new Xr(e.getFieldValue("eintrittspreise")),[e,a]);return r.jsxs(ee,{amount:n,label:`Einnahmen / Eintritt / Zuschuss${s?"":" (Schätzung)"}`,noTopBorder:!0,suffix:"ausgaben",children:[r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Gn,{optionen:t})}),r.jsx(m,{span:4,children:r.jsx(P,{decimals:2,disabled:!0,label:"Reg",name:["eintrittspreise","preisprofil","regulaer"],suffix:"€"})}),r.jsx(m,{span:4,children:r.jsx(je,{decimals:2,label:"Erm",suffix:"€",value:i.ermaessigt})}),r.jsx(m,{span:4,children:r.jsx(je,{decimals:2,label:"Mitgl",suffix:"€",value:i.mitglied})})]}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(P,{decimals:2,label:"Reservix",name:["kasse","einnahmenReservix"],suffix:"€"})}),r.jsx(m,{span:12,children:r.jsx(P,{decimals:0,label:'Anzahl Tickets (für Excel) - falls "0" Schnitt aus Eintritt',name:["kasse","anzahlReservix"]})})]}),r.jsx(Jr,{justify:"center",children:s?r.jsx(We.Text,{strong:!0,type:"success",children:'Kasse ist freigegeben, verwende "Abendkasse"'}):r.jsx(We.Text,{strong:!0,type:"danger",children:'Schätzung, da Kasse noch nicht freigegeben, verwende "Gäste (erw.)"'})}),r.jsxs(E,{children:[r.jsx(m,{span:8,children:r.jsx(P,{decimals:2,disabled:!0,label:"Zuschüsse (für alte Konzerte)",name:["eintrittspreise","zuschuss"],suffix:"€"})}),r.jsx(m,{span:8,children:r.jsx(P,{decimals:2,disabled:!0,label:"Abendkasse (Tickets)",name:["kasse",s?"einnahmeTicketsEUR":"nix"],suffix:"€"})}),r.jsx(m,{span:8,children:r.jsx(P,{decimals:0,disabled:!!s,label:"Gäste (erw.)",name:["eintrittspreise","erwarteteBesucher"]})})]})]})}class Ni{constructor(t){this.dateirider=[],this.backlineJazzclub=[],this.backlineRockshop=[],this.checked=!1,this.fluegel=!1,t&&Kn(t).length&&Object.assign(this,t,{dateirider:t.dateirider||[]})}updateDateirider(t){const n=vn.pushImage(this.dateirider,t);return n?(this.dateirider=n,!0):!1}removeDateirider(t){this.dateirider=vn.dropImage(this.dateirider,t)}}function Qt(){const e=q(),t=D("unterkunft",{preserve:!0});return o.useMemo(()=>new ie(e.getFieldsValue(!0)).unterkunft,[t])}function vr(){const e=q(),{kostenTotalEUR:t}=Qt(),n=D(["artist","brauchtHotel"],{preserve:!0}),s=D("kosten",{preserve:!0});return o.useMemo(()=>{const a=new ie(e.getFieldsValue(!0));return a.kasse.ausgabenOhneGage+a.kosten.totalEUR+(a.artist.brauchtHotel?t:0)},[t,n,s])}function Ii(){const{roomsTotalEUR:e,transportEUR:t}=Qt();return D(["artist","brauchtHotel"],{preserve:!0})&&r.jsxs(r.Fragment,{children:[r.jsxs(E,{children:[r.jsx(m,{span:18,children:r.jsx(H.Item,{children:r.jsx("b",{children:"Hotel:"})})}),r.jsx(m,{span:6,children:r.jsx(je,{decimals:2,suffix:"€",value:e||0})})]}),r.jsxs(E,{children:[r.jsx(m,{span:18,children:r.jsx(H.Item,{children:r.jsx("b",{children:"Hotel (Transport):"})})}),r.jsx(m,{span:6,children:r.jsx(je,{decimals:2,suffix:"€",value:t||0})})]})]})}function Fi(){const{istFreigegeben:e,ausgabenOhneGage:t}=Ln();return e&&r.jsxs(E,{children:[r.jsx(m,{span:18,children:r.jsx(H.Item,{children:r.jsx("b",{children:"Abendkasse (ohne Gage):"})})}),r.jsx(m,{span:6,children:r.jsx(je,{decimals:2,suffix:"€",value:t})})]})}const Ui=["ohne","7% MWSt.","19% MWSt.","18,8% Ausland"];function Ki(){const e=q(),t=vr(),n=D(["kosten","gagenEUR"],{preserve:!0}),s=D(["kosten","gagenSteuer"],{preserve:!0}),a=o.useMemo(()=>new Ft(e.getFieldValue("kosten")),[e,n,s]),i=o.useMemo(()=>n*.05,[n]),l=D(["kasse","einnahmenReservix"],{preserve:!0}),c=D(["kasse","einnahmeTicketsEUR"],{preserve:!0}),u=o.useMemo(()=>new Zt(new ie(e.getFieldsValue(!0))),[e,c,l]),{lg:d}=Ht();return r.jsxs(ee,{amount:t,label:"Kosten / Ausgaben",noTopBorder:d,suffix:"ausgaben",children:[r.jsxs(E,{children:[r.jsx(m,{span:6,children:r.jsx(P,{decimals:2,label:"Gagen",name:["kosten","gagenEUR"],suffix:"€"})}),r.jsx(m,{span:6,children:r.jsx(ye,{label:"Steuer",name:["kosten","gagenSteuer"],options:Ui})}),r.jsx(m,{span:6,children:r.jsx(ye,{label:"Deal",name:["kosten","deal"],options:Ft.deals})}),r.jsx(m,{span:6,children:r.jsx(je,{decimals:2,label:"Total",suffix:"€",value:a.gagenTotalEUR})})]}),r.jsxs(E,{children:[r.jsx(m,{sm:12,xs:24,children:r.jsx(je,{decimals:2,label:"KSK (auf Gagen netto ohne Deal)",suffix:"€",value:i})}),r.jsx(m,{sm:12,xs:24,children:r.jsx(je,{decimals:2,label:"GEMA (auf Eintritt und Reservix)",suffix:"€",value:u.gema})})]}),r.jsx(re,{label:"Provision Agentur",path:["kosten","provisionAgentur"]}),new Ni(e.getFieldValue("technik")).fluegel?r.jsx(re,{label:"Flügelstimmer",path:["kosten","fluegelstimmerEUR"]}):null,r.jsx(Rt,{label:"Werbung 1",path:["kosten","werbung1"]}),r.jsx(Rt,{label:"Werbung 2",path:["kosten","werbung2"]}),r.jsx(Rt,{label:"Werbung 3",path:["kosten","werbung3"]}),r.jsx(re,{label:"Catering Musiker (unbar)",path:["kosten","cateringMusiker"]}),r.jsx(re,{label:"Catering Personal (unbar)",path:["kosten","cateringPersonal"]}),r.jsx(re,{label:"Personal (unbar)",path:["kosten","personal"]}),r.jsx(re,{label:"Tontechniker (unbar)",path:["kosten","tontechniker"]}),r.jsx(re,{label:"Lichttechniker (unbar)",path:["kosten","lichttechniker"]}),r.jsx(Fi,{}),r.jsx(Ii,{}),r.jsx(E,{children:r.jsx(lt,{label:"Gage in BAR an der Abendkasse",name:["kosten","gageBAR"]})}),r.jsx(re,{disabled:!0,label:"Backline Rockshop",path:["kosten","backlineEUR"]}),r.jsx(re,{disabled:!0,label:"Technik Zumietung",path:["kosten","technikAngebot1EUR"]}),r.jsx(re,{disabled:!0,label:"Saalmiete",path:["kosten","saalmiete"]})]})}function Bi(){const e=q(),t=vr(),n=xr(),s=D(["artist","brauchtHotel"],{preserve:!0}),a=D(["kosten","deal"],{preserve:!0}),i=o.useMemo(()=>{const d=new ie(e.getFieldsValue(!0));return new Zt(d)},[n,t,e,s,a]);function l(d){return`${_r(d)} €`}const c=[{title:"",dataIndex:"first",key:"first",render:d=>r.jsx("b",{children:d}),align:"right"},{title:"Eintritt",dataIndex:"second",key:"second",align:"right"},{title:"Ausgaben",dataIndex:"third",key:"third",align:"right"},{title:"Überschuss",dataIndex:"fourth",key:"fourth",align:"right"}],u=[{key:1,first:"",second:l((i==null?void 0:i.einnahmenGesamtEUR)??0),third:l((i==null?void 0:i.kostenGesamtEUR)??0),fourth:l((i==null?void 0:i.bruttoUeberschussEUR)??0)},{key:2,first:"Anteilig an Band:",second:"",third:"",fourth:l((i==null?void 0:i.dealAbsolutEUR)??0)}];return r.jsxs(ee,{amount:i==null?void 0:i.dealUeberschussTotal,label:"Kostenübersicht / Break-Even",suffix:"concert",children:[r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(We.Text,{strong:!0,type:"danger",children:"Solange nicht freigegeben, sind die Werte eine Schätzung. Bei freiem Eintritt wird mit 10 € pro Gast gerechnet."})})}),r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(qr,{columns:c,dataSource:u,pagination:!1,size:"small"})})})]})}function Li(){return r.jsxs(E,{children:[r.jsxs(m,{lg:12,xs:24,children:[r.jsx(Pi,{}),r.jsx(Bi,{})]}),r.jsx(m,{lg:12,xs:24,children:r.jsx(Ki,{})})]})}function Hi({id:e,onChange:t,value:n,fireChange:s,dependency:a}){const[i,l]=o.useState(J()),[c,u]=o.useState(J());o.useEffect(()=>{n&&(l(J(n[0])),u(J(n[1])))},[n]);const d=D([a]),h=o.useMemo(()=>J(d),[d]),f=o.useCallback(p=>{const x=p==null?void 0:p[0],b=p==null?void 0:p[1];t==null||t([x==null?void 0:x.toDate(),b==null?void 0:b.toDate()]),s==null||s()},[t,s]),g=o.useCallback(p=>!(p&&p.isAfter(h.subtract(7,"days"))),[h]);return r.jsx(Nn.RangePicker,{allowClear:!1,disabledDate:a?g:void 0,format:"ddd DD.MM.YY",id:e,onCalendarChange:f,style:{width:"100%"},value:[i,c]})}function $i({names:e,label:t,dependency:n,onChange:s}){return r.jsx(Es,{dependencies:n?[n]:void 0,hasFeedback:!0,label:t?r.jsx("b",{children:t+":"}):"",names:e,rules:n?[({getFieldValue:a})=>({validator:(i,l)=>{const c=a(n);return J(l).isAfter(J(c).subtract(7,"days"))?Promise.resolve():Promise.reject(new Error("Darf frühestens 1 Woche vor der Veranstaltung liegen"))}}),({getFieldValue:a})=>({validator:(i,l)=>{const c=a(e[1]);return J(c).diff(J(l))?Promise.resolve():Promise.reject(new Error("Muss mindestens 1 Nacht sein"))}})]:[],style:t?{}:{marginBottom:0},children:r.jsx(Hi,{dependency:n,fireChange:s})})}function Gi(){const e=q(),{optionen:t}=W(),{hotelpreiseAlsDefault:n,setHotelpreiseAlsDefault:s}=o.useContext(mt),a=D(["hotel","name"],{form:e,preserve:!0}),i=D("startDate",{form:e,preserve:!0}),l=D(["unterkunft","anreiseDate"],{form:e,preserve:!0});o.useEffect(()=>{const h=J(i);if(h&&!J(l).isAfter(h.subtract(7,"day"))){const f=h.add(1,"day");e.setFieldValue(["unterkunft","anreiseDate"],h),e.setFieldValue(["unterkunft","abreiseDate"],f)}},[l,i,e]),o.useEffect(()=>{if(ae(t==null?void 0:t.hotels,{name:a})){const h=ae(t.hotelpreise,["name",a]);if(h){const{einzelEUR:f,suiteEUR:g,doppelEUR:p}=h;e.setFieldsValue({unterkunft:{einzelEUR:f,suiteEUR:g,doppelEUR:p}})}}},[a]);const{anzNacht:c,roomsTotalEUR:u}=Qt(),d=o.useCallback(h=>s(h.target.checked),[s]);return r.jsxs(ee,{amount:u,label:"Zimmer",suffix:"hotel",children:[r.jsxs(E,{children:[r.jsxs(m,{span:12,children:[r.jsx($i,{dependency:"startDate",label:"An- und Abreise",names:[["unterkunft","anreiseDate"],["unterkunft","abreiseDate"]]}),c]}),r.jsx(m,{span:12,children:r.jsx(H.Item,{label:r.jsx("b",{children:"Kommentar:"}),name:["unterkunft","kommentar"],children:r.jsx(qe,{rows:7})})})]}),r.jsxs(E,{children:[r.jsx(m,{span:3,children:r.jsx(P,{decimals:0,label:"Einzel",name:["unterkunft","einzelNum"]})}),r.jsx(m,{span:5,children:r.jsx(P,{decimals:2,label:"Preis",name:["unterkunft","einzelEUR"],suffix:"€"})}),r.jsx(m,{span:3,children:r.jsx(P,{decimals:0,label:"Doppel",name:["unterkunft","doppelNum"]})}),r.jsx(m,{span:5,children:r.jsx(P,{decimals:2,label:"Preis",name:["unterkunft","doppelEUR"],suffix:"€"})}),r.jsx(m,{span:3,children:r.jsx(P,{decimals:0,label:"Suite",name:["unterkunft","suiteNum"]})}),r.jsx(m,{span:5,children:r.jsx(P,{decimals:2,label:"Preis",name:["unterkunft","suiteEUR"],suffix:"€"})})]}),r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(Fn,{checked:n,onChange:d,children:r.jsx("b",{children:"Preise als Default übernehmen"})})})})]})}function Vi(){const e=q(),[t,n]=o.useState(0),s=o.useCallback(function(){const h=new ie(e.getFieldsValue(!0));n(h.unterkunft.transportEUR)},[e]),{currentUser:a}=W(),i=o.useCallback(()=>{const d=new ie(e.getFieldsValue(!0)),h=d.unterkunft,f=encodeURIComponent(`${d.hotel.name}<${d.hotel.email}>`),g=encodeURIComponent(`Jazzclub Reservierungsanfrage für ${h.anreiseDisplayDate}`),p=h.einzelNum,x=p>0?`${p} Einzelzimmer, `:"",b=h.doppelNum,y=b>0?`${b} Doppelzimmer, `:"",v=h.suiteNum,w=v>0?`${v} Suite(n), `:"",k=encodeURIComponent(`Sehr geehrte Damen und Herren,

bitte reservieren Sie für den Jazzclub Karlsruhe e.V.:
${x}${y}${w} für ${h.anzNacht}.
Anreise: ${h.anreiseDisplayDate}, Abreise: ${h.abreiseDisplayDate}

Die Namen der Gäste lauten:
${h.kommentar}

Mit freundlichen Grüßen,
${a.name}`);window.location.href="mailto:"+f+"?subject="+g+"&body="+k},[e,a.name]);o.useEffect(s,[s]);const{lg:l}=Ht(),{useToken:c}=Zr,u=c().token;return r.jsxs(r.Fragment,{children:[r.jsxs(ee,{amount:t,label:"Transport",noTopBorder:l,suffix:"hotel",children:[r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(H.Item,{label:r.jsx("b",{children:"Anmerkungen:"}),name:["unterkunft","kommentar"],children:r.jsx(qe,{rows:7})})})}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(Un,{label:"Bus / Sonstiges",name:["unterkunft","sonstiges"],noAdd:!0,options:["Parkgenehmigung","Stromanschluss"]})}),r.jsx(m,{span:12,children:r.jsx(P,{decimals:2,label:"Summe",name:["unterkunft","transportEUR"],onChange:s,suffix:"€"})})]})]}),r.jsxs(E,{children:[r.jsx(m,{span:12,children:r.jsx(lt,{label:"Hotel Angefragt",name:["unterkunft","angefragt"]})}),r.jsx(m,{span:12,children:r.jsx(lt,{label:"Hotel Bestätigt",name:["unterkunft","bestaetigt"]})})]}),r.jsx(E,{children:r.jsx(m,{span:12,children:r.jsx(Bn,{theme:{token:{colorPrimary:u.colorSuccess}},children:r.jsx(Lt,{block:!0,icon:r.jsx($t,{iconName:"EnvelopeOpen"}),onClick:i,type:"primary",children:" Reservierungsmail"})})})})]})}function Wi(){const{optionen:e}=W();return r.jsxs(E,{children:[r.jsxs(m,{lg:12,xs:24,children:[r.jsx(Vn,{kontakte:e.hotels,noTopBorder:!0,selector:"hotel"}),r.jsx(Gi,{})]}),r.jsx(m,{lg:12,xs:24,children:r.jsx(Vi,{})})]})}function Yi(){return r.jsx(E,{children:r.jsx(m,{span:24,children:r.jsx(Cs,{isVermietung:!1})})})}function Se({title:e,type:t,activePage:n}){const{icon:s,color:a}=ns,{brightText:i}=W(),l=n===t,c=a(t);return r.jsxs("b",{style:{margin:-16,padding:16,backgroundColor:l?c:"inherit",color:l?i:c},children:[r.jsx($t,{iconName:s(t),style:{marginBottom:-3}}),"  ",e]})}function Xi(){const{optionen:e}=W(),[t,n]=Hn(),[s,a]=o.useState("allgemeines"),[i,l]=o.useState([]),{currentUser:c}=W(),u=o.useMemo(()=>!c.accessrights.isOrgaTeam,[c.accessrights.isOrgaTeam]),d=D(["artist","brauchtHotel"],{preserve:!0}),h=D("brauchtPresse",{preserve:!0});o.useEffect(()=>{const g=t.get("page")??"";if(c.id&&u){const p=["kasse","gaeste"].includes(g)?g:"kasse";a(p),n({page:p},{replace:!0});return}["allgemeines","gaeste","technik","ausgaben","hotel","kasse","presse"].includes(g)?a(g):(a("allgemeines"),n({page:"allgemeines"},{replace:!0}))},[c.id,u,t,n]),o.useEffect(()=>{const g={key:"kasse",label:r.jsx(Se,{activePage:s,title:"Abendkasse",type:"kasse"}),children:r.jsx(es,{})},p={key:"gaeste",label:r.jsx(Se,{activePage:s,title:"Gäste am Abend",type:"gaeste"}),children:r.jsx(ts,{})},x=[{key:"allgemeines",label:r.jsx(Se,{activePage:s,title:"Allgemeines",type:"allgemeines"}),children:r.jsx(Ls,{})},p,{key:"technik",label:r.jsx(Se,{activePage:s,title:"Technik",type:"technik"}),children:r.jsx(zi,{})},{key:"ausgaben",label:r.jsx(Se,{activePage:s,title:"Kalkulation",type:"ausgaben"}),children:r.jsx(Li,{})},{key:"hotel",label:r.jsx(Se,{activePage:s,title:"Hotel",type:"hotel"}),children:r.jsx(Wi,{})},g];if(u)return l([p,g]);if(h&&x.push({key:"presse",label:r.jsx(Se,{activePage:s,title:"Presse",type:"presse"}),children:r.jsx(Yi,{})}),d)l(x);else{const b=[...x||[]];b.splice(4,1),l(b)}},[d,e,s,u,h]);const f=o.useCallback(g=>n({page:g}),[n]);return r.jsx(Qr,{activeKey:s,items:i,onChange:f,type:"card"})}function Ji({data:e,saveForm:t,resetChanges:n,children:s}){document.title="Konzert";const[a]=rs(),{setKasseHelpOpen:i}=o.useContext(mt),{optionen:l,currentUser:c,isDirty:u}=W(),[d]=Hn(),h=o.useMemo(()=>d.get("page")==="kasse",[d]),f=D("startDate",{form:a,preserve:!0}),g=D(["kopf","titel"],{form:a,preserve:!0}),p=D(["kopf","eventTyp"],{form:a,preserve:!0}),x=D(["kopf","abgesagt"],{form:a,preserve:!0}),b=D(["id"],{form:a,preserve:!0}),y=o.useMemo(()=>ss.forJSDate(f).lesbareKurzform,[f]),v=o.useMemo(()=>{var j;return{color:((j=as((l==null?void 0:l.typenPlus)??[],"name")[p])==null?void 0:j[0].color)??is,textDecoration:x?"line-through":""}},[x,p,l==null?void 0:l.typenPlus]),w=o.useMemo(()=>c.accessrights.isOrgaTeam,[c.accessrights.isOrgaTeam]),k=o.useMemo(()=>Ss([{label:"ABGESAGT",dependsOn:["kopf","abgesagt"],path:["kopf","abgesagt"],invertColor:!0},{label:"Bestätigt",labelNotOk:"Unbestätigt",path:["kopf","confirmed"]},{label:"Technik",path:["technik","checked"]},{label:"Presse",dependsOn:"brauchtPresse",path:["presse","checked"]},{label:"Homepage",path:["kopf","kannAufHomePage"]},{label:"Social Media",path:["kopf","kannInSocialMedia"]},{label:"Hotel",dependsOn:["artist","brauchtHotel"],path:["unterkunft","bestaetigt"]}]),[]),M=o.useCallback(()=>i(!0),[i]);return r.jsx(os,{additionalButtons:[w&&r.jsx(us,{disabled:!b,isDirty:u},"more")],additionalButtonsLast:[h&&r.jsx(ls,{callback:M},"helpKasse"),r.jsx(cs,{},"cal")],data:e,dateString:y,form:a,resetChanges:n,saveForm:t,style:v,tags:k,title:g,children:s})}function Zi(){const{url:e}=In(),[t,n]=o.useState(!1),[s,a]=o.useState("[temporär]"),[i,l]=o.useState("[temporär]"),[c,u]=o.useState(!1),{data:d,refetch:h}=ds({queryKey:["konzert",e],queryFn:()=>bs(e||"")}),f=Dt({saveFunction:hs,queryKey:"konzert",successMessage:"Das Konzert wurde gespeichert",forwardForNew:!0}),g=Dt({saveFunction:fs,queryKey:"optionen"}),p=Dt({saveFunction:gs,queryKey:"rider"}),{currentUser:x,optionen:b,setMemoizedVeranstaltung:y}=W(),v=ps(),w=o.useCallback(()=>(l("[temporär]"),a("[temporär]"),u(!1),h()),[h]);o.useEffect(()=>{y({veranstaltung:d,highlight:!0})},[d,y]),o.useEffect(()=>{const S=x.accessrights;x.id&&!S.isAbendkasse&&v(`/konzert/preview/${e}`)},[x.accessrights,x.id,v,e]);const k=o.useCallback(S=>{const R=S.riderBoxes,j=new ie(S),C=j==null?void 0:j.id;if(j.id||j.initializeIdAndUrl(),!x.accessrights.isOrgaTeam&&C)return f.mutate(j);b.addOrUpdateKontakt("agenturen",j.agentur,s),j.artist.brauchtHotel&&(b.addOrUpdateKontakt("hotels",j.hotel,i),c&&b.updateHotelpreise(j.hotel,j.unterkunft.zimmerPreise)),b.updateBackline("Jazzclub",j.technik.backlineJazzclub),b.updateBackline("Rockshop",j.technik.backlineRockshop),b.updateCollection("artists",j.artist.name),g.mutate(b),p.mutate(new ms({id:e,startDate:j.startDate,boxes:R})),f.mutate(j)},[x.accessrights.isOrgaTeam,f,b,s,i,c,g,p,e]),M=o.useMemo(()=>({isKasseHelpOpen:t,setKasseHelpOpen:n,agenturauswahl:s,setAgenturauswahl:a,hotelauswahl:i,setHotelauswahl:l,hotelpreiseAlsDefault:c,setHotelpreiseAlsDefault:u}),[s,i,c,t]);return r.jsx(mt.Provider,{value:M,children:r.jsxs(Ji,{data:d,resetChanges:w,saveForm:k,children:[r.jsx(Ds,{title:"Kopiertes Konzert"}),r.jsx(Xi,{})]})})}export{Zi as default};
